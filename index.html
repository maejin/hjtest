<!--<link rel="manifest" href="/hjtest/manifest.json" />-->
<script src='/hjtest/sw.js'></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>

<script src="/hjtest/generator_base.js"></script>
<script src="/hjtest/notification_generator_base.js"></script>
<script src="/hjtest/notification_generator.js"></script>

<script language='javascript'>
/*
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/hjtest/sw.js').then(function(registration) {
      // Registration was successful
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
      // registration failed :(
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}
*/

navigator.serviceWorker.register('/hjtest/sw.js');

Notification.requestPermission(function(result) {
  if (result === 'granted') {
    navigator.serviceWorker.ready.then(function(registration) {
		//registration.showNotification('Notification with ServiceWorker');
    });
  }
});

$(document).ready(function() {


	var requirementsElement = document.getElementById('requirements'),
	element = document.getElementById('test-case');
	var generator = new NotificationGenerator(requirementsElement, element);

	generator.deserialize(document.location.hash);
	generator.setFields({
		// Visual settings
		title: ['title', GeneratorBase.FIELD_TYPE_STRING],
		body: ['body', GeneratorBase.FIELD_TYPE_STRING],
		dir: ['direction', GeneratorBase.FIELD_TYPE_STRING],
		image: ['image', GeneratorBase.FIELD_TYPE_STRING],
		icon: ['icon', GeneratorBase.FIELD_TYPE_STRING],
		badge: ['badge', GeneratorBase.FIELD_TYPE_STRING],
		// Behavioral settings
		persistent: ['persistent', GeneratorBase.FIELD_TYPE_BOOL],
		tag: ['tag', GeneratorBase.FIELD_TYPE_STRING],
		actions: ['actions', GeneratorBase.FIELD_TYPE_BUTTONS],
		notificationCloseEvent: ['notification_close_event',
							 GeneratorBase.FIELD_TYPE_BOOL],
		// Reaction settings
		action: ['action', GeneratorBase.FIELD_TYPE_STRING],
		close: ['close', GeneratorBase.FIELD_TYPE_BOOL],
	  });



	//var generator = new NotificationGenerator();

	// Defines the behavior of the display button. It will be disabled
          // when the notification is being displayed, and enabled again when
          // that either succeeded, or an error occurred.
          var displayButton = document.getElementById('action-display');
          displayButton.addEventListener('click', function() {
            displayButton.disabled = true;
            generator.display().then(function() {
              displayButton.disabled = false;
            });
          });
          // Defines the behavior of the get displayed button.
          /*var getDisplayedButton = document.getElementById('action-get-displayed');
          getDisplayedButton.addEventListener('click', function() {
              generator.getPersistent();
          });*/
          // The reset button allows the form to be reset to its initial values,
          // which is implemented by refreshing the page.
          /*var resetButton = document.getElementById('action-reset');
          resetButton.addEventListener('click', function() {
            document.location.href = document.location.pathname;
          });*/
          // Listen for messages received from the Service Worker.
          navigator.serviceWorker.addEventListener('message', function(message) {
            alert(message.data);
          });
          generator.registerServiceWorker('/hjtest/');
          generator.requestPermission();


});


//document.addEvenetListener('DOMContentLoaded', function() {
	//var requirementsElement = document.getElementById('requirements'),
	//	element = document.getElementById('test-case');

	
//})

</script>


<div id="test-case" class="test-case">
        <ul id="requirements" class="requirements">
          <li>Unable to execute the JavaScript code.</li>
        </ul>

        <!--<h2>Visual settings</h2>-->
        <ol>
			<input type='hidden' id='title' data-id="0" value="<?=json_decode('TEST!!')?>">
			<input type='hidden' id='body' value='í…ŒìŠ¤íŠ¸ì¤‘ìž…ë‹ˆë‹¤~~ í…ŒìŠ¤íŠ¸ì¤‘ìž…ë‹ˆë‹¤~~ í…ŒìŠ¤íŠ¸ì¤‘ìž…ë‹ˆë‹¤~~'>
			<input type='hidden' id='direction' value='ltr'>

          <!--<li>
            <label for="title">Title</label>
            <select id="title">
              <option data-id="0" value="í‘¸ì‹œí…ŒìŠ¤íŠ¸!">Short sentence (LTR)</option>
              <option data-id="1" value="×›×•×ª×¨×ª ×”×•×“×¢×”">Short sentence (RTL)</option>
              <option data-id="2" value="í‘¸ì‹œ ì•ŒëžŒ í…ŒìŠ¤íŠ¸ìž…ë‹ˆë‹¤! ë¼ë¼ë¼ë§ˆë„ë¼ë¨¼;í•˜ã…“ã…ë‚­ëŸ¬ë‚˜ì–¼;ã…ë‚˜ã…£ã…“ã…‡ã„¹;ë‚­ã…;ëŸ¬ã…ã…ã„´;ã…‡ëžŒã„´ã…‡;ã…“ã„¹">Long sentence (LTR)</option>
              <option data-id="3" value="×”×ž×‘×•×¨×’×¨×™×: ××‘×Ÿ ×”×¤×™× ×” ×©×œ ×›×œ ××¨×•×—×ª ×‘×•×§×¨ ×ž×–×™× ×”. ×¦'×™×–×‘×•×¨×’×¨">Long sentence (RTL)</option>
              <option data-id="4" value="sshhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh">Repetitive characters (LTR)</option>
              <option data-id="5" value="×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©">Repetitive characters (RTL)</option>
              <option data-id="6" value="ðŸ˜ðŸš’â¤ðŸ˜¹ðŸ™‹âŒ›â‡ðŸš…â˜Žâ˜º">Unicode smileys</option>
              <option data-id="7" value="">Empty</option>
              <option data-custom value="custom">Custom</option>
            </select>
            <input id="title_custom" type="text" />
          </li>
          <li>
            <label for="body">Body</label>
            <select id="body">
              <option data-id="0" value="Notification content">One sentence (LTR)</option>
              <option data-id="1" value="×ª×•×›×Ÿ ×”×•×“×¢×”">One sentence (RTL)</option>
              <option data-id="2" value="This is the notification's message. It may be able to stretch over multiple lines, or become visible when the notification is expanded by the user, depending on the notification center that's being used.">Multiple sentences (LTR)</option>
              <option data-id="3" value="×–×”×• ×”×ž×¡×¨ ×©×œ ×”×”×•×“×¢×”. ×–×” ×¢×©×•×™ ×œ×”×™×•×ª ×ž×¡×•×’×œ ×œ×ž×ª×•×— ×¢×œ ×§×•×•×™× ×ž×¨×•×‘×™×, ××• ×œ×”×™×•×ª ×’×œ×•×™, ×›××©×¨ ×”×”×•×“×¢×” ×ž×•×¨×—×‘×ª ×¢×œ ×™×“×™ ×”×ž×©×ª×ž×©, ×‘×”×ª×× ×œ×”×•×“×¢×” ×©×”×ž×¨×›×– × ×ž×¦× ×‘×©×™×ž×•×©">Multiple sentences (RTL)</option>
              <option data-id="4" value="sshhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh">Repetitive characters (LTR)</option>
              <option data-id="5" value="×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©×©">Repetitive characters (RTL)</option>
              <option data-id="6" value="ðŸŒ‡ðŸ˜ƒðŸˆðŸ˜†ðŸœðŸ»ðŸ˜‹â›…â›³ðŸ˜š">Unicode smileys</option>
              <option data-id="7" value="">Empty</option>
              <option data-custom value="custom">Custom</option>
            </select>
            <input id="body_custom" type="text" />
          </li>
          <li>
            <label for="direction" not-implemented title="Not implemented by Chrome.">Direction</label>
            <select id="direction">
              <option data-id="0" value="ltr">Left-to-right</option>
              <option data-id="1" value="rtl">Right-to-left</option>
              <option data-id="2" value="auto">Auto</option>
            </select>
          </li>-->
          <li>
            <label for="image" not-implemented title="Not yet standardized. Proposed at https://github.com/whatwg/notifications/issues/79">Image</label>
            <select id="image">
              <option data-id="0" value="">No image</option>
              <option data-id="1" value="/hjtest/images/my-push-logo.png">desk photo (JPEG, 192x192)</option>
              <option data-custom value="custom">Custom</option>
            </select>
            <input id="image_custom" type="text" />
          </li>
          <li>
            <label for="icon">Icon</label>
            <select id="icon">
              <option data-id="0" value="/hjtest/images/badge.png">Normal PNG icon (256x256)</option>
              <option data-id="1" value="/resources/icons/15.jpg">Normal JPEG icon (256x256)</option>
              <option data-id="2" value="/resources/icons/16.gif">Static GIF icon (256x256)</option>
              <option data-id="3" value="/resources/icons/19.gif">Animated GIF icon (256x256)</option>
              <option data-id="4" value="">---------------</option>
              <option data-id="5" value="/resources/icons/17.png">Tiny icon (PNG, 32x32)</option>
              <option data-id="6" value="/resources/icons/18.png">Huge icon (PNG, 3333x5230)</option>
              <option data-id="7" value="">No icon</option>
              <option data-custom value="custom">Custom</option>
            </select>
            <input id="icon_custom" type="text" />
          </li>
          <li>
            <label for="badge">Badge</label>
            <select id="badge">
              <option data-id="0" value="/hjtest/images/badge.png">Cat icon</option>
              <option data-id="1" value="">No icon</option>
              <option data-custom value="custom">Custom</option>
            </select>
            <input id="badge_custom" type="text" />
          </li>
        </ol>

        <h2>Behavioral settings</h2>
        <ol>
          <li>
            <label for="persistent">Persistent</label>
            <input type="checkbox" checked id="persistent" />
          </li>
          <li>
            <label for="tag">Tag</label>
            <select id="tag">
              <option data-id="0" value="">No tag</option>
              <option data-id="1" value="tag-1">tag-1</option>
              <option data-id="2" value="tag-2">tag-2</option>
            </select>
          </li>
          
          <li>
            <label for="actions" not-implemented title="Not implemented by Firefox.">Actions</label>
            <select id="actions">
              <!-- values will be interpreted as "button1Title$$button1Icon$$button1Type$$button1placeholder;;button2Title$$button2Icon;;button3Title" etc. -->
              <option data-id="0" value="">No actions</option>
              <option data-id="1" value="I am a button!$$/resources/icons/11.png">One action (LTR)</option>
              <option data-id="2" value="×˜×§×¡×˜ ×§×¦×¨$$/resources/icons/11.png">One action (RTL)</option>
              <option data-id="3" value="Yes$$/resources/icons/11.png;;No$$/resources/icons/14.png">Two actions (LTR)</option>
              <option data-id="6" value="Like$$/resources/icons/11.png;;Ø¨Ø¬Ù„Ø¯Ù Ø£Ø²Ø±Ù‚$$/resources/icons/14.png">Two actions (LTR, RTL)</option>
              <option data-id="7" value="Ø¨Ø¬Ù„Ø¯Ù Ø£Ø²Ø±Ù‚$$/resources/icons/11.png;;Like$$/resources/icons/14.png">Two actions (RTL, LTR)</option>
              <option data-id="11" value="×›Ö¼Öµ×Ÿ$$/resources/icons/11.png;;×œ×$$/resources/icons/14.png">Two actions (RTL)</option>
              <option data-id="4" value="×˜×§×¡×˜ ×§×¦×¨$$/resources/icons/11.png;;×˜×§×¡×˜ ×–×” ×”×•× ××¨×•×š ×¢×‘×•×¨ ×œ×—×¦×Ÿ$$/resources/icons/14.png">Two actions (RTL)</option>
              <option data-id="5" value="Maybe$$/resources/icons/question.png;;Yes$$/resources/icons/check.png;;No$$/resources/icons/cross.png">Three actions</option>
              <option data-id="14" value="ðŸ‘ Like;;Â¯\\_(ãƒ„)_/Â¯">Two actions (unicode)</option>
              <option data-id="8" value="ðŸ˜¸ðŸ˜ðŸ˜‚ðŸ˜±ðŸ™ˆ">One action (emoticons, no icon)</option>
              <option data-id="9" value="No icon">One action (no icon)</option>
              <option data-id="10" value="$$/resources/icons/11.png">One action (empty title)</option>
              <option data-id="12" value="Reply$$/resources/icons/11.png$$text">One action (type text)</option>
              <option data-id="13" value="Reply$$/resources/icons/11.png$$text$$Placeholder">One action (type text with placeholder)</option>
            </select>
          </li>
           <li>
            <label for="notification_close_event" not-implemented title="Not implemented by Firefox.">notificationclose event</label>
            <input type="checkbox" id="notification_close_event" />
          </li>
        </ol>

        <h2>Reaction settings</h2>
        <ol>
          <li>
            <label for="action">Action</label>
            <select id="action">
              <option data-id="0" value="default">Focus or open a new window.</option>
              <option data-id="1" value="focus-only">Only try to focus.</option>
              <option data-id="2" value="open-only">Only open a new window.</option>
              <option data-id="3" value="message">Display an alert().</option>
              <option data-id="4" value="nothing">Do nothing.</option>
            </select>
          </li>
          <li>
            <label for="close">Close it?</label>
            <input type="checkbox" checked id="close" />
          </li>
        </ol>

        <p>
          <!--<button id="action-reset">Reset</button>-->
          <button id="action-display">í‘¸ì‰¬ í…ŒìŠ¤íŠ¸</button>
          <!--<button id="action-get-displayed">Get displayed notifications</button>-->
        </p>
      </div>